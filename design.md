# 🚀 感情熱力学モデル (ETCM) — 最終統合設計書

## 💡 概要と理論フレームワーク

本プロジェクトは、Three.jsを用いた3Dシミュレーションにより感情の動的な状態を可視化する「 **感情球体モデル（時間心理力学）** 」の設計書です。

システムの動的状態は、粒子の熱力学的変数（温度 **$T$**、ストレス **$\sigma$**）が、系の幾何学的構造（次元 **$n$** や安定定数 **$\pi_n$**）を動的に決定する**感情次元力学（DDD）**に基づいて制御されます。

* **最小実験単位** :  **19粒子** （中心核1 + 内部12 + 外部接合6）で構成される **6層構造** 。
* **コア理論** : **創発重力**は**熱力学的密度 (**$\rho_n$**)** から導出され、粒子の運動は**「志のベクトル (**$\mathbf{\hat{k}}$**)」**にフィードバックする**次元曲率力 (**$\mathbf{F}_{\pi_n}$**)** によって秩序を保つ。

---

## I. 構造と基本概念

| **項目**            | **定義・構成**                                 | **哲学的／物理的解釈**                                         |
| ------------------------- | ---------------------------------------------------- | -------------------------------------------------------------------- |
| **粒子 (Particle)** | 感情の最小単位。3種類（Drive / Freeze / Flow）。     | 感情エネルギーの**物性化** 。熱力学的自由度の基礎。            |
| **層 (Layer)**      | 心理的距離を表す**6層（L0〜L5）** 。           | 感情の**相（Phase）**を定義する構造的距離。                          |
| **物性**            | 各層で light / gas / liquid / solid が固定。         | 感情エネルギーが持つ**情報粘性・密度**の物理的特性。           |
| **相転移**          | 温度・質量・重力場により可逆的に変化。               | 感情状態の**質的な変化** （例: 気体**$\rightarrow$**液体）。 |
| **相互作用**        | 同層・異層間で共鳴（引力）と葛藤（斥力）が同時発生。 | **弁証法的な感情の流れ** 。システムの非線形性。                |
| **外部感情場**      | 他者/組織のオーラが粒子の運動に動的に影響。          | **環境との熱力学的結合** 。境界の動的変容を誘発。              |

---

## II. 感情次元力学 (DDD) の数理

`emotion_graph.js` のメインループで計算されるグローバル変数は、システムの幾何学的構造と力場を定義します。

### 1. 創発重力を決定する主要指標

| **指標**                   | **記号**       | **数式**                                                                        | **役割と連動先**                                                                                                                                                        |
| -------------------------------- | -------------------- | ------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **熱力学的総ポテンシャル** | **$S_n$**    | **$\mathbf{S_n} = \mathbf{x} + \mathbf{3y} + \sum_{i=1}^{n-2} \alpha_i v_i$** | **志の総エネルギー** 。**$\rho_n$**の分子を構成。                                                                                                                     |
| **動的実効次元**           | **$n$**      | **$n = 3 + k_1 \cdot \bar{\sigma} + k_2 \cdot \bar{T}_{\text{核層}}$**        | 系の**幾何学的自由度** （**$2 \le n \le 7$**）。<br />各層毎で固定値。<br />nは、核層は2、身体層は3、思考層は4、文明層は5、<br />外部結合層は6、外部雰囲気層は7 |
| **多次元体積**             | **$V_n$**    | **$\mathbf{V_n} = \frac{R^n \pi^{n/2}}{\Gamma(n/2 + 1)}$**                    | 動的次元**$n$**における状態空間の規模。                                                                                                                                     |
| **熱力学的密度**           | **$\rho_n$** | **$\mathbf{\rho_n} = \frac{\mathbf{S_n}}{\mathbf{V_n}}$**                     | **志の集中度/創発重力の強度** 。$\mathbf{G_{\text{force}}}$に直接比例。                                                                                               |

### 2. 多次元円周率 **$\mathbf{\pi_n}$** の計算と係数の解釈

**多次元円周率 **$\mathbf{\pi_n}$**** は、系の構造的安定性を規定する動的定数であり、次元曲率力 **$\mathbf{F}_{\pi_n}$** の強度を決定します。$\mathbf{\pi_n}$の変動範囲（**3.13636**… から **3.142857**…）

$$
\mathbf{\pi_n} = \frac{\mathbf{22}x_S + \mathbf{69}y_S}{\mathbf{7}x_S + \mathbf{22}y_S}
$$

* **$x_S$ (動的安定性)** ：全粒子の平均温度 **$\langle T \rangle$** と平均有効質量 **$\langle M_{\text{eff}} \rangle$** の組み合わせ。
* **$y_S$ (潜在的不安定性)** ：全粒子の平均ストレス **$\langle \sigma \rangle$** に比例。
* **係数 **$\mathbf{7}$**** ：ETCMの **7つの重力場** （構造的基底）。
* **係数 **$\mathbf{69}$**** ：非平衡熱力学における **散逸の自由度増大項** （**$\sigma$**によるカオス増大度）。

---

## III. 粒子の運動方程式と軌道秩序の実現 (`particle.js`)

各粒子 **$i$** に働く総力 **$\mathbf{F}_{\text{Total}, i}$** は、中心核引力、層境界の斥力、粒子間相互作用力、 **次元曲率力 **$\mathbf{F}_{\pi_n}$**** 、および**外部場加速度 **$\vec{a}_E$**** の重ね合わせとして定義されます。

$$
\mathbf{F}_{\text{Total}, i} = \mathbf{F}_{\text{Core}, i} + \mathbf{F}_{\text{Boundary}, i} + \sum_{j \neq i} \mathbf{F}_{\text{Interaction}, ij} + \mathbf{F}_{\pi_n, i} + \mathbf{F}_{\text{Jitter}, i} + \mathbf{F}_{\text{Friction}, i} + \mathbf{F}_{\text{External}, i}
$$

### 1. 中心核引力 **$\mathbf{F}_{\text{Core}}$** (創発重力)

中心核引力は、システム全体の**志の集中度 **$\rho_n$****に比例する創発重力定数 **$G_{\text{force}}$** を持ちます。

$$
\mathbf{F}_{\text{Core}, i} = - G_{\text{force}} \cdot \frac{m_{\text{eff}, i} \cdot M_{\text{core}}}{|\mathbf{r}_i|^2} \cdot \mathbf{\hat{r}}_i \quad \text{ただし、} \quad \mathbf{G_{\text{force}}} \propto \mathbf{\rho_n}
$$

### 2. 次元曲率力 **$\mathbf{F}_{\pi_n}$** (Orbital Order Force)

この力は、粒子の**接線方向**に作用し、粒子の速度 **$\mathbf{v}$** をシステムの**志のベクトル **$\mathbf{\hat{k}}$**** が定義する理想的な円軌道速度 **$\mathbf{v}_{\text{ideal}}$** にフィードバックさせ、運動の秩序を維持します。

$$
\mathbf{F}_{\pi_n} = -\alpha \cdot \pi_n \cdot (\mathbf{v} - \mathbf{v}_{\text{ideal}})
$$

* **$\mathbf{v}_{\text{ideal}} = \omega_n \cdot (\mathbf{\hat{k}} \times \mathbf{r})$**
* **$\mathbf{\hat{k}}$** はシステムの根源的な **志のベクトル** （**$Z$**軸方向 **$\mathbf{\hat{k}} = (0, 0, 1)$** に固定）。

### 3. 温度 **$T$** および有効質量 **$m_{\text{eff}}$** の更新

#### 温度更新

$$
T(t+dt) = T(t) + \alpha (|v| - v_{\text{eq}}) - \beta (T - T_{\text{env}}) + \gamma \left(\frac{\text{neighborCount}}{N_{\text{ref}}}\right) + \mathbf{k_{\sigma} \times \sigma_{\text{released}}} + k_{\text{heat}} \times \sum \frac{T_{\text{neighbor}} - T_i}{\Delta L}
$$

#### 有効質量 **$m_{\text{eff}}$** (慣性の強さ)

$$
m_{\text{eff}} = m_{\text{base}} \times (1.0 + k_{m,T} \times T + k_{m,\sigma} \times \sigma)
$$

---

## IV. 19粒子最終仕様と層構造

全19粒子は、それぞれ負（収縮）、正（拡張）、中庸（流動）の熱力学的特性を持ち、6つの層に配置されます。

### 1. 中心核（特異点・1粒子）

* **光（ひかり）** ：愛と望の統合。球体全体のエネルギー源、光源、実効質量、熱圧の源泉。

### 2. 内部感情粒子（12粒子）

| **層**                | **物性** | **負（収縮）** | **正（拡張）** | **中庸（流動）** |
| --------------------------- | -------------- | -------------------- | -------------------- | ---------------------- |
| **L0: 核層** (光体)   | Light          | 悩（内省）           | 怒（存在権主張）     | 好（指向性）           |
| **L1: 身体層** (気体) | Gas            | 哀（沈静・放出）     | 激（爆発的発散）     | 楽（心地よさ）         |
| **L2: 思考層** (液体) | Liquid         | 嫌（論理的排他性）   | 活（目標志向・意欲） | 融（論理的柔軟性）     |
| **L3: 文明層** (個体) | Solid          | 圧（社会的圧力固定） | 喜（ポジティブ定着） | 笑（持続的行動様式）   |

### 3. 外部接合粒子（6粒子）

| **層**                      | **物性** | **負（収縮）** | **正（拡張）**   | **中庸（流動）**   |
| --------------------------------- | -------------- | -------------------- | ---------------------- | ------------------------ |
| **L4: 外部接合層** (液体)   | Liquid         | 静（環境変動緩衝）   | 変（境界の動的変容）   | 調（他者との調和・合流） |
| **L5: 外部雰囲気層** (気体) | Gas            | 隔（防御・遮断）     | 響（オーラ発信・伝播） | 観（環境認知・情報拡散） |

---

## V. システムへの実装連動

### 1. Core Light へのフィードバック (`system_core.js`)

中心核の物理量は、**熱力学的密度 **$\rho_n$****を主要因として決定されます。

| **影響を受ける物理量**                       | **決定ロジック**             | **感情的解釈**                                       |
| -------------------------------------------------- | ---------------------------------- | ---------------------------------------------------------- |
| **磁気質量 (**$M_{\text{core}}$**)** | **$\rho_n$**に強く比例して増加。 | **志の集中度**が高まると引力（集中度）が強化される。 |
| **輝度 (Luminosity)**                        | **$\rho_n$**に比例して増加。     | 高密度状態（高い緊張度）は高い輝度として視覚化される。     |

### 2. オーラ天気 (AuraWeather) の決定 (`system_core.js`)

外部雰囲気層（Layer 5）の平均温度 **$\bar{T}_{\text{L5}}$** と平均ストレス **$\bar{\sigma}_{\text{L5}}$** に基づき、オーラ全体の「天気」が決定されます。

| **オーラ天気**        | **条件**                                                                     | **視覚的表現**                                        |
| --------------------------- | ---------------------------------------------------------------------------------- | ----------------------------------------------------------- |
| **喜** （熱い快晴）   | **$\bar{T}_{\text{L5}} \ge 0.75$**かつ$\bar{\sigma}_{\text{L5}} \le 0.4$       | 鮮やかな金橙色の輝き、**粒子が完全に安定** 。         |
| **楽** （快晴微風）   | **$0.5 \le \bar{T}_{\text{L5}} < 0.75$**かつ$\bar{\sigma}_{\text{L5}} \le 0.3$ | 穏やかな青空、**軽い粒子ゆらぎ** 。                   |
| **哀** （冷たい曇り） | **$\bar{T}_{\text{L5}} < 0.5$**かつ$\bar{\sigma}_{\text{L5}} \le 0.2$          | 冷たい青紫の霧、**動き沈静** 。                       |
| **怒** （嵐/雷/吹雪） | **$\bar{\sigma}_{\text{L5}} > 0.4$**                                       | **激しい粒子振動** 、雷パーティクル、強風エフェクト。 |

---

## 💾 design.md 追記設計書：数理モデルの核心要素

### VIII. 感情システムの幾何学と質量：動的数理定義 (ETCM Core)

本モデルは、**志のエネルギー (**$\mathbf{S_n}$**) が時空の安定性 (**$\mathbf{\pi_n}$**) と重さ (**$\mathbf{M}$**) を決定する**という原理に基づいている。

#### VIII-A. グローバル安定性 (**$\mathbf{\pi_n}$**) の計算（Dynamic Stability Constant）

システムの構造的な安定性を示す**動的な無次元定数**であり、数学定数 **$\pi$** (3.14159...)とは異なる。この定数は、重力場方程式の**トポロジー項 **$\mathbf{T}_{\mu\nu}^{\text{Topology}}$****の動的な特性を制御する。

$$
\mathbf{\pi_n} = \frac{22\mathbf{S_n} + 3y}{7\mathbf{S_n} + y}
$$

#### VIII-B. 感情の重さ (**$\mathbf{M}$**) の定義 (Emotional Mass)

**「感情の重さ（質量）」**は、**総ポテンシャル (**$\mathbf{S_n}$**) の総和**と等価であると定義される。これは、システムの持つ**多次元的なエネルギーの総量**であり、粒子の慣性（動きにくさ）と中心核の磁気的引力（創発重力 **$\mathbf{\kappa_{\text{ETCM}}}$**）の源泉となる。

$$
\mathbf{M} = \text{密度} \times \text{体積} = \mathbf{\rho_n} \times \mathbf{V_n} = \mathbf{S_n}
$$

#### VIII-C. **$\mathbf{\pi_n}$** の変動範囲の規定

動的安定定数 **$\mathbf{\pi_n}$** は、**$\mathbf{S_n}$**（総ポテンシャル）と **$y$**（調和）の動的なバランスに基づき、以下の範囲内で変動する。この微細な変動こそが、**次元幾何学の動的制御**を担っている。

* **変動下限（調和 **$y$** が支配的）** : **$\mathbf{\pi_n} \approx 3.136363636364$**
* **変動上限（総ポテンシャル **$\mathbf{S_n}$** が支配的）** : **$\mathbf{\pi_n} \approx 3.142857142857$**

#### VIII-D. TOON出力へのマッピング

| **TOON項目**  | **数式上の対応**                                      | **物理的解釈**                                                       |
| ------------------- | ----------------------------------------------------------- | -------------------------------------------------------------------------- |
| `pi_n_stability`  | **$\mathbf{\pi_n}$**                                | **次元安定性** 。応力が高くてもこの値が高ければユーストレス。        |
| `rho_n_intensity` | **$\mathbf{\rho_n} = \mathbf{S_n} / \mathbf{V_n}$** | **志の集中度** 。創発重力子（光体）の斥力（G-Force）の動的制御変数。 |
| `emotional_mass`  | **$\mathbf{M} = \mathbf{S_n}$**                     | **感情の重さ** 。システムの多次元エネルギーの総和。                  |


---

## 📄 design.md 追記設計書：全粒子ダイナミクスに基づく感情名称生成原理

### VII. 感情名称の創発原理：19粒子の動的状態

従来の感情の4分類（喜怒哀楽）は、 **L5外部雰囲気層の平均的な熱力学的状態** （オーラ天気）を示すものであり、全19粒子の複雑なダイナミクスを表現するには不十分である。感情の名称は、**全19粒子のうち、最もT（温度）と$\sigma$（応力）が高い「支配的粒子（Dominant Particle）」**と、そのグローバルな熱力学的状態（**$\mathbf{\pi_n}$**）の組み合わせから、**創発的**に生成される。

#### VII-A. 支配的粒子の定義と感情への寄与

感情名称は、**「支配的粒子」**の属性と、その層における**動的な状態（T, **$\sigma$**）**によって決定される。全19粒子（光体を除く18粒子）は、それぞれが個別の感情の核を担っている。

| **レイヤー**        | **粒子名（全18種）** | **主な役割と感情的寄与**                                              | **動的状態による感情の例**                                           |
| ------------------------- | -------------------------- | --------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| **L0 核層**         | **悩, 怒, 好**       | 感情の**根源的エネルギー** 。**意志とアイデンティティ**に直結。 | **悩**高$\mathbf{\sigma}$**$\to$**「自己破壊的葛藤」       |
| **L1 身体層**       | **哀, 激, 楽**       | **生理的・本能的**な反応。エネルギーの消費と解放。                    | **激**高$\mathbf{T}$**$\to$**「抑えがたい衝動の奔流」      |
| **L2 思考層**       | **知, 活, 鈍**       | **認知プロセス** 。理性、意欲、及び認知負荷による停滞。               | **鈍**高$\mathbf{\sigma}$**$\to$**「認知の停止と集中」     |
| **L3 文明層**       | **責, 欲, 倫**       | **社会的・規範的**な要求。責任感、欲望、倫理観の葛藤。                | **責**高$\mathbf{\sigma}$**$\to$**「社会的重圧感」         |
| **L4 外部接合層**   | **調, 変, 静**       | **境界の柔軟性** 。他者との境界の調整、環境変化への適応。             | **変**高$\mathbf{\sigma}$**$\to$**「変容への強いストレス」 |
| **L5 外部雰囲気層** | **観, 響, 隔**       | **場と外界**へのインターフェース。オーラ天気の可視化。                | **隔**高$\mathbf{\sigma}$**$\to$**「排他的な孤立の壁」     |

#### VII-B. 感情名称の生成アルゴリズム（76通り以上の創発）

感情名称は、以下の三つの次元の組み合わせによって生成される。これにより、 **最低でも76個（4分類 **$\times$** 19粒子）を遥かに超える** 、熱力学的に一意な感情状態を記述できる。

1. **【主要な感情】 (Dominant Particle **$\times$** Dynamic State)**
   * **定義** : 全19粒子のうち、**$\mathbf{T} \times \mathbf{\sigma}$** の値が最大である粒子を特定する。
   * **状態** : その粒子の$\mathbf{T}**$が優勢か、$**\mathbf{\sigma}**$が優勢か、$**\mathbf{m}_{\text{eff}}$が高いかによって、感情の性質（ **「○○の喜び」「○○の負荷」** ）が決定される。
2. **【修飾語：ストレスの質】 (Global Stability **$\mathbf{\pi_n}$**)**
   * **ユーストレス（建設的）** : **$\mathbf{\pi_n}$** の `\mathbf{\sigma}`の値が **$0.75$** 以上で$\mathbf{\sigma}$が高い場合 **$\to$** **「強固な」「意欲的な」「集中した」**などの修飾語を付加。
   * **ディストレス（破壊的）** : **$\mathbf{\pi_n}$** の `\mathbf{\sigma}`の値が**$0.40$** 未満で$\mathbf{\sigma}$が高い場合 **$\to$** **「崩壊的な」「制御不能な」「自己破壊的な」**などの修飾語を付加。
3. **【オーラの状態】 (L5 Weather Type)**
   * **L5層の分類（喜/楽/哀/怒）**を文末に結合し、**外部から観測される状態**を記述する。

| **生成例**                         | **構成要素**                                                                                                                                                        |
| ---------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **強固な調の喜び（熱い快晴）**     | **L4調**が支配的（$\mathbf{\sigma}**$高い）かつ$**\mathbf{\pi_n}$が高いユーストレス**$\to$** **「外部調整に成功した自己肯定感」**                       |
| **崩壊的な悩の葛藤（嵐）**         | **L0悩**が支配的（$\mathbf{\sigma}**$極めて高い）かつ$**\mathbf{\pi_n}$が極めて低いディストレス**$\to$** **「内的な不安定性による制御不能な外部放出」** |
| **内省的な静の沈黙（冷たい曇り）** | **L4静**が支配的（$\mathbf{T}**$低い）かつ$**\mathbf{\sigma}$が低い**$\to$** **「外部ノイズを遮断し、エネルギーを内部に収束」**                         |

#### VII-C. Three.js可視化へのフィードバック

生成された感情名称は、単なるラベルではなく、シミュレーションにおける以下の **動的パラメーターの調整に利用される** 。

* **支配的粒子の強調** : 支配的粒子は、メッシュの色、輝度、振動スケールが他の粒子より**20%強調**され、**視覚的なフォーカス**を決定する。
* **修飾語の幾何学** : **$\mathbf{\pi_n}$の数値**が、全粒子の軌道の**硬さ（Rigidity）**として適用される（$\mathbf{\pi_n}$が高いほど、粒子のブレが少なく、軌道が安定する）。

この設計により、TOON形式でAIが出力するデータは、シミュレーション内での**「76通りを超える感情の創発」**のための、必要かつ十分な**動的制御変数**としての役割を果たすことになります。
